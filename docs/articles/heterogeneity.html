<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Endemism is sensitive to variation in environmental heterogeneity • phyloregion</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Endemism is sensitive to variation in environmental heterogeneity">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phyloregion</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Benchmark.html">Benchmarking phyloregion</a>
    </li>
    <li>
      <a href="../articles/heterogeneity.html">Endemism is sensitive to variation in environmental heterogeneity</a>
    </li>
    <li>
      <a href="../articles/phyloregion-intro.html">An introduction to the phyloregion package</a>
    </li>
    <li>
      <a href="../articles/scalability.html">Scalability of phyloregion</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/darunabas/phyloregion">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Endemism is sensitive to variation in environmental heterogeneity</h1>
                        <h4 class="author">Barnabas H. Daru, Harith Farooq, Alexandre Antonelli &amp; Søren Faurby</h4>
            
            <h4 class="date">March 17, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/darunabas/phyloregion/blob/master/vignettes/heterogeneity.Rmd"><code>vignettes/heterogeneity.Rmd</code></a></small>
      <div class="hidden name"><code>heterogeneity.Rmd</code></div>

    </div>

    
    
<div id="environmental-data" class="section level2">
<h2 class="hasAnchor">
<a href="#environmental-data" class="anchor"></a>1. Environmental data</h2>
<p>We selected key environmental factors that are commonly used to examine biodiversity-environment associations. These variables included mean annual temperature (temperature henceforth), mean annual precipitation (precipitation henceforth), annual net primary productivity (productivity henceforth) and elevation.</p>
<p>Temperature, precipitation and elevation were downloaded as raster layers from the WorldClim database<span class="citation"><sup>1</sup></span> at a resolution of 2.5’. Productivity was downloaded from NASA Moderate Resolution Imaging Spectroradiometer (MODIS) at a resolution of 1 km and calculated using the MOD17 algorithm. These variables were converted to Behrmann equal-area projection using the function <code>projectRaster</code> in the R package <code>raster</code><span class="citation"><sup>2</sup></span>.</p>
</div>
<div id="environmental-heterogeneity" class="section level2">
<h2 class="hasAnchor">
<a href="#environmental-heterogeneity" class="anchor"></a>2. Environmental heterogeneity</h2>
<p>To measure environmental heterogeneity, for each cell and across grain sizes (50 km, 100 km, 200 km, 400 km and 800 km), we extracted the standard deviation of the four environmental variables (temperature, precipitation, elevation and productivity) using the function <code>extract_climate</code> in the R package <code>phyloregionExtras</code><span class="citation"><sup>3</sup></span>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">extract_climate &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">val =</span> <span class="st">"val"</span>, <span class="dt">FUN =</span> sd, ...){</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  x &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/projectRaster.html">projectRaster</a></span>(x, <span class="dt">crs =</span> (<span class="st">'+proj=longlat'</span>))</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  ras &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/projectRaster.html">projectRaster</a></span>(x, <span class="dt">crs =</span> <span class="kw">proj4string</span>(y), <span class="dt">over =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  p &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/extract.html">extract</a></span>(ras, y, ...)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(p, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(x)) <span class="kw">FUN</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="cf">else</span> <span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  y<span class="op">$</span>foo &lt;-<span class="st"> </span>m</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(y)[<span class="kw"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="st">"foo"</span>, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(y))] &lt;-<span class="st"> </span>val</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  y</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">######### Arguments #######################</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># x: A raster file of the environmental variable</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co"># y: Spatial polygons corresponding to the study area to extract the variable.</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co"># val: String to rename the column with the extracted variable.</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co"># FUN: The function to summarize the values (e.g. sd, mean)</span></a></code></pre></div>
</div>
<div id="mixed-effects-models-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#mixed-effects-models-analysis" class="anchor"></a>3. Mixed effects models analysis</h2>
<p>We compared the performance of two models: standard linear models, and linear mixed effects model. The goodness of fit of the models was selected by the Akaike Information Criterion (AIC)<span class="citation"><sup>4</sup></span> using our R function <code>clim_heterogeneity</code> with <code>aic</code> set to <code>TRUE</code>.</p>
<p>The linear mixed effects model outperforms the standard linear model as suggested by the values of AIC and was used for the next analyses.</p>
<p>We performed a linear mixed-effects models at each scale to analyse the relationship between endemism (PE or WE) and environmental variables, taking into account the spatial structure of the patterns.</p>
<p>A linear mixed effects model allows the modeling of data as an additive combination of fixed effects (unknown mean and coefficients of a model), random effects (the spatially dependent random variation in the geostatistical context) and independent random error (variation in geostatistics)<span class="citation"><sup>5</sup></span>. The form of a mixed effect model is expressed as: <span class="math display">\[Y_i = x_i\beta + s_i + Ɛ_i\]</span> where <span class="math inline">\(Y_i\)</span> represents the response variable at grid cell or location <span class="math inline">\(i\)</span>, <span class="math inline">\(x_i\)</span> is a vector containing spatially referenced nonrandom predictors, and <span class="math inline">\(\beta\)</span> is a vector of the fixed effect parameters, <span class="math inline">\(s_i\)</span> is a spatially correlated random effect and <span class="math inline">\(Ɛ_i\)</span> is the random measurement error.</p>
<p>Endemism (phylogenetic endemism or weighted endemism) was used as the primary (response) variable in the spatial models, whereas the standard deviation of the four environmental variables (temperature, precipitation, elevation and productivity) were used as covariates, including geographical Cartesian <span class="math inline">\(x/y-\)</span> coordinates (longitude and latitude). This spatial structure was created as a matrix of coordinates of each cell’s centroid, and we computed Euclidean distances and weights of neighbouring points (function <code>dnearneigh</code> in R package <code>spdep</code><span class="citation"><sup>6</sup></span>) for the spatial autocorrelation analysis. Thus, the autocovariate was included as an additional variable along with the standard deviation of temperature, precipitation, elevation, and productivity whereas grid cell identity was included as a random covariate. The linear mixed effects modeling was done with the function <code>lme</code> in R package <code>nlme</code><span class="citation"><sup>7</sup></span>.</p>
<p>In order to illustrate the process we have added all codes below for the analyses:</p>
<p>First, load the packages for the analysis:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(spdep)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(nlme)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Function for computing environmental heterogeneity</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">clim_heterogeneity &lt;-<span class="st"> </span><span class="cf">function</span> (x, <span class="dt">y =</span> <span class="st">"y"</span>, <span class="dt">nbs =</span> <span class="fl">2e+07</span>, <span class="dt">x1 =</span> <span class="st">"x1"</span>, <span class="dt">x2 =</span> <span class="st">"x2"</span>,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                                <span class="dt">x3 =</span> <span class="st">"x3"</span>, <span class="dt">x4 =</span> <span class="st">"x4"</span>, <span class="dt">lon =</span> <span class="st">"lon"</span>, <span class="dt">lat =</span> <span class="st">"lat"</span>,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                                <span class="dt">grids =</span> <span class="st">"grids"</span>, <span class="dt">aic =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">{</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">    x &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(x)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">    x &lt;-<span class="st"> </span>x[<span class="kw"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span>(x), ]</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">    x &lt;-<span class="st"> </span>x[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(y, x1, x2, x3, x4, lon, lat, grids)]</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">    <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(x) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y"</span>, <span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>, <span class="st">"x4"</span>, <span class="st">"lon"</span>, <span class="st">"lat"</span>, <span class="st">"grids"</span>)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">    x<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(x<span class="op">$</span>y <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">    x<span class="op">$</span>x1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(x<span class="op">$</span>x1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">    x<span class="op">$</span>x2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(x<span class="op">$</span>x2 <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">    x<span class="op">$</span>x3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(x<span class="op">$</span>x3 <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">    x<span class="op">$</span>x4 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(x<span class="op">$</span>x4 <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">    m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(x[, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(lon, lat)])</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">    x<span class="op">$</span>ac &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/spdep/man/autocov_dist.html">autocov_dist</a></span>(x<span class="op">$</span>y, m, <span class="dt">nbs =</span> nbs, <span class="dt">type =</span> <span class="st">"inverse.squared"</span>, <span class="dt">zero.policy =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">    mod_lme &lt;-<span class="st"> </span>nlme<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x3 <span class="op">+</span><span class="st"> </span>x4 <span class="op">+</span><span class="st"> </span>ac, <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>grids, <span class="dt">data =</span> x)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">    mod_lm &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x3 <span class="op">+</span><span class="st"> </span>x3 <span class="op">+</span><span class="st"> </span>x4 <span class="op">+</span><span class="st"> </span>ac, <span class="dt">data =</span> x)</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">    aic.out =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span>(mod_lme, mod_lm)</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">    df &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(nlme<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/nlme/man/intervals.html">intervals</a></span>(mod_lme)<span class="op">$</span>fixed)</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">    fm &lt;-<span class="st"> </span>nlme<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/nlme/man/anova.lme.html">anova.lme</a></span>(mod_lme, <span class="dt">type =</span> <span class="st">"marginal"</span>)<span class="op">$</span><span class="st">"p-value"</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22">    res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(df, <span class="dt">p_val =</span> fm)</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">    res &lt;-<span class="st"> </span>res[<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"(Intercept)"</span>, <span class="st">"ac"</span>), ]</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">    <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(x1, x2, x3, x4)</a>
<a class="sourceLine" id="cb3-25" data-line-number="25">    res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">clim =</span> <span class="kw"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span>(res), res, <span class="dt">row.names =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb3-26" data-line-number="26">    <span class="cf">if</span> (aic <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb3-27" data-line-number="27">        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">random_est=</span>res, <span class="dt">AIC=</span>aic.out, <span class="dt">mod_lm=</span>mod_lm, <span class="dt">mod_lme=</span>mod_lme))</a>
<a class="sourceLine" id="cb3-28" data-line-number="28">    }</a>
<a class="sourceLine" id="cb3-29" data-line-number="29">    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(res)</a>
<a class="sourceLine" id="cb3-30" data-line-number="30">}</a>
<a class="sourceLine" id="cb3-31" data-line-number="31"></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">################################ Arguments ####################################</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co"># x: A data.frame</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co"># y: A response variable</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co"># nbs: Neighbourhood distance</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co"># x1..x4 An explanatory variables corresponding to environmental variables</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co"># lon: Column name of the longitude.</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co"># lat: Column name of the latitude.</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="co"># grids: Column name of the column containing grid cells</span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co"># aic: Show full models both lme and lm including their AICs.</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"></a>
<a class="sourceLine" id="cb3-43" data-line-number="43">fun1 &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb3-44" data-line-number="44">    res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(x, <span class="st">"</span><span class="ch">\\</span><span class="st">/"</span>)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb3-45" data-line-number="45">    res &lt;-<span class="st"> </span>res[[<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(res)]]</a>
<a class="sourceLine" id="cb3-46" data-line-number="46">    res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span>(res, <span class="st">"</span><span class="ch">\\</span><span class="st">_"</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb3-47" data-line-number="47">    res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">".csv"</span>, <span class="st">""</span>, res)</a>
<a class="sourceLine" id="cb3-48" data-line-number="48">    res</a>
<a class="sourceLine" id="cb3-49" data-line-number="49">}</a>
<a class="sourceLine" id="cb3-50" data-line-number="50"></a>
<a class="sourceLine" id="cb3-51" data-line-number="51"></a>
<a class="sourceLine" id="cb3-52" data-line-number="52"><span class="co"># Download the data frames from Dropbox and save in temporary folder</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53">dir =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span>()</a>
<a class="sourceLine" id="cb3-54" data-line-number="54"><span class="kw"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(dir)</a>
<a class="sourceLine" id="cb3-55" data-line-number="55"><span class="kw"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(<span class="dt">url =</span> <span class="st">"https://github.com/darunabas/extras/archive/master.zip"</span>,</a>
<a class="sourceLine" id="cb3-56" data-line-number="56">              <span class="dt">destfile =</span> <span class="st">"extras-master.zip"</span>)</a>
<a class="sourceLine" id="cb3-57" data-line-number="57"><span class="kw"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span>(<span class="dt">zipfile =</span> <span class="st">"extras-master.zip"</span>)</a>
<a class="sourceLine" id="cb3-58" data-line-number="58"><span class="kw"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(<span class="dt">dir =</span> <span class="st">"extras-master"</span>)</a>
<a class="sourceLine" id="cb3-59" data-line-number="59"><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>()</a></code></pre></div>
<pre><code>## [1] "environment" "mergedSA"    "shapefile"</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">t1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="st">'environment/birds/WE'</span>, <span class="dt">pattern=</span><span class="st">"*.csv"</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">t2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="st">'environment/birds/PE'</span>, <span class="dt">pattern=</span><span class="st">"*.csv"</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">t3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="st">'environment/amphibians/WE'</span>, <span class="dt">pattern=</span><span class="st">"*.csv"</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">t4 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(<span class="st">'environment/amphibians/PE'</span>, <span class="dt">pattern=</span><span class="st">"*.csv"</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">f1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(t1, fun1))</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">f2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(t2, fun1))</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">f3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(t3, fun1))</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">f4 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(t4, fun1))</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co"># load the data frames for each grain size</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">d1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(t1, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(x, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">d2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(t2, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(x, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">d3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(t3, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(x, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">d4 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(t4, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(x, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb5-16" data-line-number="16"></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(d1[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>##    grids        WE    sd_ALT    sd_MAP   sd_MAT       sd_NPP      lon      lat
## 1 v10084  340.2460  562.8624   71.9370 3.848896  15284319418 -7052646 -1737713
## 2 v10088  606.7684  404.9584   50.2280 2.356266  32349944611 -6852646 -1737713
## 3 v10089 1143.1800  767.3688  395.3724 3.936351  18044787059 -6802646 -1737713
## 4 v10090 1437.5099 1187.8156 1062.3708 5.590839  63536778570 -6752646 -1737713
## 5 v10091 1488.2875  348.5838  380.4115 1.503277 203536278064 -6702646 -1737713
## 6 v10092  867.2580  398.0916  191.2684 1.678670   3244896302 -6652646 -1737713</code></pre>
</div>
<div id="visualisation-of-results" class="section level2">
<h2 class="hasAnchor">
<a href="#visualisation-of-results" class="anchor"></a>4. Visualisation of results</h2>
<div id="environmental-heterogeneity-and-bird-weighted-endemism" class="section level3">
<h3 class="hasAnchor">
<a href="#environmental-heterogeneity-and-bird-weighted-endemism" class="anchor"></a>4.1. Environmental heterogeneity and bird weighted endemism</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">spo &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(d1, <span class="cf">function</span>(x) <span class="kw">clim_heterogeneity</span>(x, <span class="dt">y =</span> <span class="st">"WE"</span>, <span class="dt">x1 =</span> <span class="st">"sd_ALT"</span>,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                                                 <span class="dt">x2 =</span> <span class="st">"sd_MAP"</span>, <span class="dt">x3 =</span> <span class="st">"sd_MAT"</span>,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                                                 <span class="dt">x4 =</span> <span class="st">"sd_NPP"</span>, <span class="dt">nbs =</span> <span class="dv">2000000</span>))</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">ll &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(spo)<span class="op">-</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">z1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="st">"rbind"</span>, spo), <span class="dt">scale=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(f1, ll))</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">pd &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(<span class="dt">width =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(z1, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>scale, <span class="dt">y=</span>est., <span class="dt">group=</span>clim, <span class="dt">color=</span>clim)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">position =</span> pd) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">position =</span> pd)<span class="op">+</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymax =</span> upper, <span class="dt">ymin =</span> lower),</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">                  <span class="dt">size  =</span> <span class="fl">.4</span>,</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">                  <span class="dt">width =</span> <span class="fl">.15</span>,</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">                  <span class="dt">position =</span> pd)<span class="op">+</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'#1b9e77'</span>,<span class="st">'#d95f02'</span>, <span class="st">"#7570b3"</span>, <span class="st">"#e7298a"</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">"Estimated effects"</span>)</a></code></pre></div>
<div class="figure">
<img src="heterogeneity-unnamed-chunk-6-1.png" alt="plot of chunk unnamed-chunk-6"><p class="caption">plot of chunk unnamed-chunk-6</p>
</div>
</div>
<div id="environmental-heterogeneity-and-bird-phylogenetic-endemism" class="section level3">
<h3 class="hasAnchor">
<a href="#environmental-heterogeneity-and-bird-phylogenetic-endemism" class="anchor"></a>4.2. Environmental heterogeneity and bird phylogenetic endemism</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">spo &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(d2, <span class="cf">function</span>(x) <span class="kw">clim_heterogeneity</span>(x, <span class="dt">y =</span> <span class="st">"PE"</span>, <span class="dt">x1 =</span> <span class="st">"sd_ALT"</span>,</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                                                 <span class="dt">x2 =</span> <span class="st">"sd_MAP"</span>, <span class="dt">x3 =</span> <span class="st">"sd_MAT"</span>,</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">                                                 <span class="dt">x4 =</span> <span class="st">"sd_NPP"</span>))</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">ll &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(spo)<span class="op">-</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">z1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="st">"rbind"</span>, spo), <span class="dt">scale=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(f2, ll))</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">pd &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(<span class="dt">width =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8"></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(z1, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>scale, <span class="dt">y=</span>est., <span class="dt">group=</span>clim, <span class="dt">color=</span>clim)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">position =</span> pd) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">position =</span> pd)<span class="op">+</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymax =</span> upper, <span class="dt">ymin =</span> lower),</a>
<a class="sourceLine" id="cb8-13" data-line-number="13">                  <span class="dt">size  =</span> <span class="fl">.4</span>,</a>
<a class="sourceLine" id="cb8-14" data-line-number="14">                  <span class="dt">width =</span> <span class="fl">.15</span>,</a>
<a class="sourceLine" id="cb8-15" data-line-number="15">                  <span class="dt">position =</span> pd)<span class="op">+</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'#1b9e77'</span>,<span class="st">'#d95f02'</span>, <span class="st">"#7570b3"</span>, <span class="st">"#e7298a"</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">"Estimated effects"</span>)</a></code></pre></div>
<div class="figure">
<img src="heterogeneity-unnamed-chunk-7-1.png" alt="plot of chunk unnamed-chunk-7"><p class="caption">plot of chunk unnamed-chunk-7</p>
</div>
</div>
<div id="environmental-heterogeneity-and-amphibian-weighted-endemism" class="section level3">
<h3 class="hasAnchor">
<a href="#environmental-heterogeneity-and-amphibian-weighted-endemism" class="anchor"></a>4.3. Environmental heterogeneity and amphibian weighted endemism</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">spo &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(d3, <span class="cf">function</span>(x) <span class="kw">clim_heterogeneity</span>(x, <span class="dt">y =</span> <span class="st">"WE"</span>, <span class="dt">x1 =</span> <span class="st">"sd_ALT"</span>,</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                                                 <span class="dt">x2 =</span> <span class="st">"sd_MAP"</span>, <span class="dt">x3 =</span> <span class="st">"sd_MAT"</span>,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                                                 <span class="dt">x4 =</span> <span class="st">"sd_NPP"</span>))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">ll &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(spo)<span class="op">-</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">z1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="st">"rbind"</span>, spo), <span class="dt">scale=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(f3, ll))</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">pd &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(<span class="dt">width =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(z1, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>scale, <span class="dt">y=</span>est., <span class="dt">group=</span>clim, <span class="dt">color=</span>clim)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">position =</span> pd) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">position =</span> pd)<span class="op">+</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymax =</span> upper, <span class="dt">ymin =</span> lower),</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">                  <span class="dt">size  =</span> <span class="fl">.4</span>,</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">                  <span class="dt">width =</span> <span class="fl">.15</span>,</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">                  <span class="dt">position =</span> pd)<span class="op">+</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'#1b9e77'</span>,<span class="st">'#d95f02'</span>, <span class="st">"#7570b3"</span>, <span class="st">"#e7298a"</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">"Estimated effects"</span>)</a></code></pre></div>
<div class="figure">
<img src="heterogeneity-unnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8"><p class="caption">plot of chunk unnamed-chunk-8</p>
</div>
</div>
<div id="environmental-heterogeneity-and-amphibian-phylogenetic-endemism" class="section level3">
<h3 class="hasAnchor">
<a href="#environmental-heterogeneity-and-amphibian-phylogenetic-endemism" class="anchor"></a>4.4. Environmental heterogeneity and amphibian phylogenetic endemism</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">spo &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(d4, <span class="cf">function</span>(x) <span class="kw">clim_heterogeneity</span>(x, <span class="dt">y =</span> <span class="st">"PE"</span>, <span class="dt">x1 =</span> <span class="st">"sd_ALT"</span>,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">                                                 <span class="dt">x2 =</span> <span class="st">"sd_MAP"</span>, <span class="dt">x3 =</span> <span class="st">"sd_MAT"</span>,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                                                 <span class="dt">x4 =</span> <span class="st">"sd_NPP"</span>))</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">ll &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(spo)<span class="op">-</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">z1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="st">"rbind"</span>, spo), <span class="dt">scale=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(f4, ll))</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">pd &lt;-<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(<span class="dt">width =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(z1, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>scale, <span class="dt">y=</span>est., <span class="dt">group=</span>clim, <span class="dt">color=</span>clim)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">position =</span> pd) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">position =</span> pd)<span class="op">+</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymax =</span> upper, <span class="dt">ymin =</span> lower),</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">                  <span class="dt">size  =</span> <span class="fl">.4</span>,</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">                  <span class="dt">width =</span> <span class="fl">.15</span>,</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">                  <span class="dt">position =</span> pd)<span class="op">+</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'#1b9e77'</span>,<span class="st">'#d95f02'</span>, <span class="st">"#7570b3"</span>, <span class="st">"#e7298a"</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">""</span>, <span class="dt">y =</span> <span class="st">"Estimated effects"</span>)</a></code></pre></div>
<div class="figure">
<img src="heterogeneity-unnamed-chunk-9-1.png" alt="plot of chunk unnamed-chunk-9"><p class="caption">plot of chunk unnamed-chunk-9</p>
</div>
</div>
</div>
<div id="session-infomation" class="section level2">
<h2 class="hasAnchor">
<a href="#session-infomation" class="anchor"></a>Session Infomation</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</a></code></pre></div>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Mojave 10.14.6
## 
## Matrix products: default
## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] nlme_3.1-145  ggplot2_3.3.0 spdep_1.1-3   sf_0.8-1      spData_0.3.3  sp_1.4-1     
## [7] knitr_1.28   
## 
## loaded via a namespace (and not attached):
##  [1] gtools_3.8.1       tidyselect_1.0.0   xfun_0.12          purrr_0.3.3       
##  [5] splines_3.6.1      lattice_0.20-40    colorspace_1.4-1   expm_0.999-4      
##  [9] htmltools_0.4.0    yaml_2.2.1         rlang_0.4.5        e1071_1.7-3       
## [13] pillar_1.4.3       glue_1.3.2         withr_2.1.2        DBI_1.1.0         
## [17] lifecycle_0.2.0    stringr_1.4.0      munsell_0.5.0      gtable_0.3.0      
## [21] raster_3.0-12      codetools_0.2-16   coda_0.19-3        evaluate_0.14     
## [25] labeling_0.3       class_7.3-15       highr_0.8          Rcpp_1.0.3        
## [29] KernSmooth_2.23-16 scales_1.1.0       classInt_0.4-2     gdata_2.18.0      
## [33] farver_2.0.3       deldir_0.1-25      digest_0.6.25      stringi_1.4.6     
## [37] gmodels_2.18.1     dplyr_0.8.5        grid_3.6.1         tools_3.6.1       
## [41] LearnBayes_2.15.1  magrittr_1.5       tibble_2.1.3       crayon_1.3.4      
## [45] pkgconfig_2.0.3    MASS_7.3-51.5      Matrix_1.2-18      assertthat_0.2.1  
## [49] rmarkdown_2.1      R6_2.4.1           boot_1.3-24        units_0.6-5       
## [53] compiler_3.6.1</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>REFERENCES</h2>
<div id="refs" class="references">
<div id="ref-Hijmans2005">
<p>1. Hijmans, R. J., Cameron, S. E., Parra, J. L., Jones, P. G. &amp; Jarvis, A. Very high resolution interpolated climate surfaces for global land areas. <em>International Journal of Climatology</em> <strong>25</strong>, 1965–1978 (2005).</p>
</div>
<div id="ref-raster">
<p>2. Hijmans, R. J. <em>Raster: Geographic data analysis and modeling</em>. (2020).</p>
</div>
<div id="ref-phyloregionExtras">
<p>3. Daru, B. H., Karunarathne, P. &amp; Schliep, K. <em>PhyloregionExtras: Extras for biogeographic regionalization and spatial conservation</em>. (2020).</p>
</div>
<div id="ref-pinheiro2006">
<p>4. Pinheiro, J. &amp; Bates, D. <em>Mixed-effects models in s and s-plus</em>. (Springer Science &amp; Business Media, 2006).</p>
</div>
<div id="ref-Lark2006">
<p>5. Lark, R. M., Cullis, B. R. &amp; Welham, S. J. On spatial prediction of soil properties in the presence of a spatial trend: The empirical best linear unbiased predictor (e-blup) with reml. <em>European Journal of Soil Science</em> <strong>57</strong>, 787–799 (2006).</p>
</div>
<div id="ref-spdep">
<p>6. Bivand, R. &amp; Wong, D. W. S. Comparing implementations of global and local indicators of spatial association. <em>TEST</em> <strong>27</strong>, 716–748 (2018).</p>
</div>
<div id="ref-nlme">
<p>7. Pinheiro, J., Bates, D., DebRoy, S., Sarkar, D. &amp; R Core Team. <em>nlme: Linear and nonlinear mixed effects models</em>. (2020).</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#environmental-data">1. Environmental data</a></li>
      <li><a href="#environmental-heterogeneity">2. Environmental heterogeneity</a></li>
      <li><a href="#mixed-effects-models-analysis">3. Mixed effects models analysis</a></li>
      <li><a href="#visualisation-of-results">4. Visualisation of results</a></li>
      <li><a href="#session-infomation">Session Infomation</a></li>
      <li><a href="#references">REFERENCES</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Barnabas H. Daru, Piyal Karunarathne, Klaus Schliep.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
