<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An introduction to the phyloregion package • phyloregion</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to the phyloregion package">
<meta property="og:description" content="phyloregion">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phyloregion</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Benchmark.html">Benchmarking phyloregion</a>
    </li>
    <li>
      <a href="../articles/ed.html">Fast Evolutionary Distinctiveness in R</a>
    </li>
    <li>
      <a href="../articles/heterogeneity.html">Endemism patterns are scale dependent</a>
    </li>
    <li>
      <a href="../articles/pd.html">Phylogenetic Diversity for Large Datasets</a>
    </li>
    <li>
      <a href="../articles/phyloregion-intro.html">An introduction to the phyloregion package</a>
    </li>
    <li>
      <a href="../articles/scalability.html">Scalability of phyloregion</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/darunabas/phyloregion/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="phyloregion-intro_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An introduction to the phyloregion package</h1>
                        <h4 class="author">Barnabas H. Daru, Piyal Karunarathne &amp; Klaus Schliep</h4>
            
            <h4 class="date">July 08, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/darunabas/phyloregion/blob/master/vignettes/phyloregion-intro.Rmd"><code>vignettes/phyloregion-intro.Rmd</code></a></small>
      <div class="hidden name"><code>phyloregion-intro.Rmd</code></div>

    </div>

    
    
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>1. Installation</h2>
<p><code>phyloregion</code> is available from the <a href="https://CRAN.R-project.org/package=phyloregion">Comprehensive R Archive Network</a>, so you can use the following line of code to install and run it:</p>
<pre><code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("phyloregion")</a></code></pre>
<p>Alternatively, you can install the development version of <code>phyloregion</code> hosted on GitHub. To do this, you will need to install the <code>devtools</code> package. In R, type:</p>
<pre><code>if (!requireNamespace("remotes", quietly = TRUE)) 
    install.packages("remotes") 
remotes::install_github("darunabas/phyloregion")</code></pre>
<p>When installed, load the package in R:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/darunabas/phyloregion">phyloregion</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="overview-and-general-workflow-of-phyloregion" class="section level2">
<h2 class="hasAnchor">
<a href="#overview-and-general-workflow-of-phyloregion" class="anchor"></a>2. Overview and general workflow of <code>phyloregion</code>
</h2>
<p>The workflow of the <code>phyloregion</code> package demonstrates steps from preparation of different types of data to visualizing the results of biogeographical regionalization, together with tips on selecting the optimal method for achieving the best output, depending on the types of data used and research questions.</p>
<div class="figure">
<img src="../../../../../Google%20Drive/TAMUCC/phyloregion%20R%20package/phyloregion/vignettes/workflow.png" alt=""><p class="caption"><strong>Figure 1.</strong> Simplified workflow for analysis of biogeographical regionalization using phyloregion. Distribution data is converted to a sparse community matrix. When paired with phylogenetic data, phylobuilder creates a subtree with largest overlap from a species list, thereby ensuring complete representation of missing data; phylocommunity matrix to visualization of results.</p>
</div>
</div>
<div id="input-data" class="section level2">
<h2 class="hasAnchor">
<a href="#input-data" class="anchor"></a>3. Input data</h2>
<div id="phylogenies" class="section level3">
<h3 class="hasAnchor">
<a href="#phylogenies" class="anchor"></a>Phylogenies</h3>
<p>In R, phylogenetic relationships among species / taxa are often represented as a phylo object implemented in the <code>ape</code> package<span class="citation">(Paradis and Schliep 2018)</span>. Phylogenies (often in the Newick or Nexus formats) can be imported into R with the <code>read.tree</code> or <code>read.nexus</code> functions of the <code>ape</code> package<span class="citation">(Paradis and Schliep 2018)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://Matrix.R-forge.R-project.org/">Matrix</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">africa</span><span class="op">)</span>
<span class="va">sparse_comm</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">comm</span>

<span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">phylo</span>
<span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/drop.tip.html">keep.tip</a></span><span class="op">(</span><span class="va">tree</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/intersect.html">intersect</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sparse_comm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">tree</span>, show.tip.label<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="phyloregion-intro_files/figure-html/unnamed-chunk-2-1.png" alt="__Figure 2.__ Phylogenetic tree of the woody plants of southern Africa inferred from DNA barcodes using a maximum likelihood approach and transforming branch lengths to millions of years ago by enforcing a relaxed molecular clock and multiple calibrations [@Daru2015ddi]." width="700"><p class="caption">
<strong>Figure 2.</strong> Phylogenetic tree of the woody plants of southern Africa inferred from DNA barcodes using a maximum likelihood approach and transforming branch lengths to millions of years ago by enforcing a relaxed molecular clock and multiple calibrations <span class="citation">(Daru, Bank, and Davies 2015)</span>.
</p>
</div>
</div>
<div id="distribution-data-input" class="section level3">
<h3 class="hasAnchor">
<a href="#distribution-data-input" class="anchor"></a>Distribution data input</h3>
<p>The <code>phyloregion</code> package has functions for manipulating three kinds of distribution data: point records, polygons and raster layers. An overview can be easily obtained with the functions <code>points2comm</code>, <code>polys2comm</code> and <code>raster2comm</code> for point records, polygons, or raster layers, respectively. Depending on the data source, all three functions ultimately provide convenient interfaces to convert the distribution data to a community matrix at varying spatial grains and extents for downstream analyses.</p>
<p>We will play around with these functions in turn.</p>
</div>
<div id="function-points2comm" class="section level3">
<h3 class="hasAnchor">
<a href="#function-points2comm" class="anchor"></a><strong><em>Function <code>points2comm</code></em></strong>
</h3>
<p>Here, we will generate random points in geographic space, similar to data obtained from museum records, GBIF, iDigBio, or CIESIN which typically have columns of geographic coordinates for each observation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"nigeria/nigeria.rds"</span>, package <span class="op">=</span> <span class="st">"phyloregion"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spsample.html">spsample</a></span><span class="op">(</span><span class="va">s</span>, <span class="fl">10000</span>, type <span class="op">=</span> <span class="st">"nonaligned"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span>
<span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"sp"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span><span class="op">$</span><span class="va">taxon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">species</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">nrow</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/raster2comm.html">points2comm</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">m</span>, mask <span class="op">=</span> <span class="va">s</span>, res <span class="op">=</span> <span class="fl">0.5</span>, lon <span class="op">=</span> <span class="st">"lon"</span>, lat <span class="op">=</span> <span class="st">"lat"</span>,
            species <span class="op">=</span> <span class="st">"taxon"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">pt</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## 5 x 5 sparse Matrix of class "dgCMatrix"
##      sp1 sp10 sp100 sp1000 sp101
## v100   .    .     .      .     1
## v101   .    .     .      .     .
## v102   .    .     .      .     .
## v103   .    1     .      .     .
## v104   .    .     .      .     .</code></pre>
</div>
<div id="function-polys2comm" class="section level3">
<h3 class="hasAnchor">
<a href="#function-polys2comm" class="anchor"></a><strong><em>Function <code>polys2comm</code></em></strong>
</h3>
<p>This function converts polygons to a community matrix at varying spatial grains and extents for downstream analyses. Polygons can be derived from the IUCN Redlist spatial database (https: //www.iucnredlist.org/resources/spatial-data-download), published monographs or field guides validated by taxonomic experts. To illustrate this function, we will use the function <code>random_species</code> to generate random polygons for five random species over the landscape of Nigeria as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"nigeria/nigeria.rds"</span>, package<span class="op">=</span><span class="st">"phyloregion"</span><span class="op">)</span><span class="op">)</span>
<span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/random_species.html">random_species</a></span><span class="op">(</span><span class="fl">100</span>, species<span class="op">=</span><span class="fl">5</span>, shp<span class="op">=</span><span class="va">s</span><span class="op">)</span>
<span class="va">pol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/raster2comm.html">polys2comm</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">sp</span>, species <span class="op">=</span> <span class="st">"species"</span>, trace<span class="op">=</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>## 
  |                                              
  |                                        |   0%
  |                                              
  |========                                |  20%
  |                                              
  |================                        |  40%
  |                                              
  |========================                |  60%
  |                                              
  |================================        |  80%
  |                                              
  |========================================| 100%</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">pol</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## 5 x 5 sparse Matrix of class "dgCMatrix"
##        species1 species2 species3 species4 species5
## v27905        .        .        1        1        .
## v27906        1        .        1        1        .
## v27907        1        .        1        1        .
## v27908        1        .        1        1        .
## v27909        1        .        1        1        .</code></pre>
</div>
<div id="function-raster2comm" class="section level3">
<h3 class="hasAnchor">
<a href="#function-raster2comm" class="anchor"></a><strong><em>Function <code>raster2comm</code></em></strong>
</h3>
<p>This third function, converts raster layers (often derived from species distribution modeling, such as aquamaps<span class="citation">(Kaschner et al. 2008)</span>) to a community matrix.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"NGAplants"</span>, package<span class="op">=</span><span class="st">"phyloregion"</span><span class="op">)</span>
<span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">fdir</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span><span class="op">(</span><span class="va">fdir</span><span class="op">)</span><span class="op">)</span>
<span class="va">ras</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/raster2comm.html">raster2comm</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span></code></pre></div>
<pre><code>## 
  |                                              
  |                                        |   0%
  |                                              
  |=====                                   |  12%
  |                                              
  |==========                              |  25%
  |                                              
  |===============                         |  38%
  |                                              
  |====================                    |  50%
  |                                              
  |=========================               |  62%
  |                                              
  |==============================          |  75%
  |                                              
  |===================================     |  88%
  |                                              
  |========================================| 100%</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">ras</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## 6 x 8 sparse Matrix of class "dgCMatrix"
##      Chytranthus_gilletii Commelina_ramulosa Cymbopogon_caesius
## v100                    .                  .                  .
## v101                    .                  .                  .
## v102                    .                  .                  .
## v103                    .                  .                  .
## v104                    .                  .                  .
## v105                    .                  .                  .
##      Dalechampia_ipomoeifolia Grewia_barombiensis Indigofera_berhautiana
## v100                        1                   .                      .
## v101                        1                   .                      .
## v102                        1                   .                      .
## v103                        1                   .                      .
## v104                        1                   .                      .
## v105                        1                   .                      .
##      Indigofera_erecta Indigofera_oubanguiensis
## v100                 .                        .
## v101                 .                        .
## v102                 .                        .
## v103                 .                        .
## v104                 .                        .
## v105                 .                        .</code></pre>
<p>The object <code>ras</code> above also returns two objects: a community data frame and a shapefile of grid cells with the numbers of species per cell and can be plotted as a heatmap using our nice <code>plot_swatch</code> function as follows:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"nigeria/SR_Naija.rds"</span>, package <span class="op">=</span> <span class="st">"phyloregion"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_swatch.html">plot_swatch</a></span><span class="op">(</span><span class="va">s</span>, values <span class="op">=</span> <span class="va">s</span><span class="op">$</span><span class="va">SR</span>, leg<span class="op">=</span><span class="fl">1</span>, border<span class="op">=</span><span class="cn">NA</span>, 
            col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span>, palette <span class="op">=</span> <span class="st">"Blue-Red 3"</span>, rev<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="phyloregion-intro_files/figure-html/unnamed-chunk-6-1.png" alt="__Figure 3.__ Species richness of plants in Nigeria across equal area grid cells. This is to demonstrate how the function `plot_swatch` works." width="50%"><p class="caption">
<strong>Figure 3.</strong> Species richness of plants in Nigeria across equal area grid cells. This is to demonstrate how the function <code>plot_swatch</code> works.
</p>
</div>
</div>
<div id="community-data" class="section level3">
<h3 class="hasAnchor">
<a href="#community-data" class="anchor"></a>Community data</h3>
<p>Community data are commonly stored in a matrix with the sites as rows and species / operational taxonomic units (OTUs) as columns. The elements of the matrix are numeric values indicating the abundance/observations or presence/absence (0/1) of OTUs in different sites. In practice, such a matrix can contain many zero values because species are known to generally have unimodal distributions along environmental gradients <span class="citation">(Ter Braak and Prentice 2004)</span>, and storing and analyzing every single element of that matrix can be computationally challenging and expensive.</p>
<p><code>phyloregion</code> differs from other R packages (e.g. vegan <span class="citation">(Oksanen et al. 2019)</span>, picante <span class="citation">(Kembel et al. 2010)</span> or betapart<span class="citation">(Baselga and Orme 2012)</span>) in that the data are not stored in a (dense) <code>matrix</code> or <code>data.frame</code> but as a sparse matrix making use of the infrastructure provided by the Matrix package <span class="citation">(Bates and Maechler 2019)</span>. A sparse matrix is a matrix with a high proportion of zero entries<span class="citation">(Duff 1977)</span>, of which only the non-zero entries are stored and used for downstream analysis.</p>
<p>A sparse matrix representation has two advantages. First the community matrix can be stored in a much memory efficient manner, allowing analysis of larger datasets. Second, for very large datasets spanning thousands of taxa and spatial scales, computations with a sparse matrix are often much faster.<br>
The <code>phyloregion</code> package contains functions to conveniently change between data formats.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://Matrix.R-forge.R-project.org/">Matrix</a></span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">africa</span><span class="op">)</span>
<span class="va">sparse_comm</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">comm</span>
<span class="va">dense_comm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">sparse_comm</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/object.size.html">object.size</a></span><span class="op">(</span><span class="va">dense_comm</span><span class="op">)</span></code></pre></div>
<pre><code>## 4216952 bytes</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html">object.size</a></span><span class="op">(</span><span class="va">sparse_comm</span><span class="op">)</span></code></pre></div>
<pre><code>## 885952 bytes</code></pre>
<p>Here, the data set in the dense matrix representation consumes roughly five times more memory than the sparse representation.</p>
</div>
</div>
<div id="analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis" class="anchor"></a>4. Analysis</h2>
<div id="alpha-diversity" class="section level3">
<h3 class="hasAnchor">
<a href="#alpha-diversity" class="anchor"></a>Alpha diversity</h3>
<p>We demonstrate the utility of <code>phyloregion</code> in mapping standard conservation metrics of species richness, weighted endemism (<code>weighted_endemism</code>) and threat (<code>map_traits</code>) as well as fast computations of phylodiversity measures such as phylogenetic diversity (<code>PD</code>), phylogenetic endemism (<code>phylo_endemism</code>), and evolutionary distinctiveness and global endangerment (<code>EDGE</code>). The major advantage of these functions compared to available tools e.g. biodiverse <span class="citation">(Laffan, Lubarsky, and Rosauer 2010)</span>, is the ability to utilize sparse matrix that speeds up the analyses without exhausting computer memories, making it ideal for handling any data from small local scales to large regional and global scales.</p>
<div id="function-weighted_endemism" class="section level4">
<h4 class="hasAnchor">
<a href="#function-weighted_endemism" class="anchor"></a>Function <code>weighted_endemism</code>
</h4>
<p>Weighted endemism is species richness inversely weighted by species ranges<span class="citation">(Crisp et al. 2001)</span>,<span class="citation">(Laffan and Crisp 2003)</span>,<span class="citation">(Barnabas H. Daru et al. 2020)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Attaching package: 'raster'</code></pre>
<pre><code>## The following objects are masked from 'package:ape':
## 
##     rotate, zoom</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">africa</span><span class="op">)</span>
<span class="va">Endm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weighted_endemism.html">weighted_endemism</a></span><span class="op">(</span><span class="va">africa</span><span class="op">$</span><span class="va">comm</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">Endm</span><span class="op">)</span></code></pre></div>
<pre><code>##    v3635    v3636    v3637    v3638    v3639    v3640 
## 1.770041 2.637894 1.825862 1.270093 1.043782 0.259324</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/merge.html">merge</a></span><span class="op">(</span><span class="va">africa</span><span class="op">$</span><span class="va">polys</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>grids<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">Endm</span><span class="op">)</span>, WE<span class="op">=</span><span class="va">Endm</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"grids"</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="va">m</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">m</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">WE</span><span class="op">)</span>,<span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_swatch.html">plot_swatch</a></span><span class="op">(</span><span class="va">m</span>, values <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">WE</span>, leg <span class="op">=</span> <span class="fl">3</span>, border <span class="op">=</span> <span class="cn">NA</span>,
            col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span>, palette <span class="op">=</span> <span class="st">"Blue-Red 3"</span>, rev<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="phyloregion-intro_files/figure-html/unnamed-chunk-8-1.png" alt="__Figure 4.__ Geographic distributions of weighted endemism for woody plants of southern Africa." width="50%"><p class="caption">
<strong>Figure 4.</strong> Geographic distributions of weighted endemism for woody plants of southern Africa.
</p>
</div>
</div>
<div id="function-pd-phylogenetic-diversity" class="section level4">
<h4 class="hasAnchor">
<a href="#function-pd-phylogenetic-diversity" class="anchor"></a>Function <code>PD</code> – phylogenetic diversity</h4>
<p>Phylogenetic diversity (<code>PD</code>) represents the length of evolutionary pathways that connects a given set of taxa on a rooted phylogenetic tree <span class="citation">(Faith 1992)</span>. This metric is often characterised in units of time (millions of years, for dated phylogenies). We will map PD for plants of southern Africa.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">africa</span><span class="op">)</span>
<span class="va">comm</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">comm</span>
<span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">phylo</span>
<span class="va">poly</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">polys</span>

<span class="va">mypd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PD.html">PD</a></span><span class="op">(</span><span class="va">comm</span>, <span class="va">tree</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">mypd</span><span class="op">)</span></code></pre></div>
<pre><code>##    v3635    v3636    v3637    v3638    v3639    v3640 
## 4226.216 5372.009 4377.735 3783.992 3260.111 1032.685</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/merge.html">merge</a></span><span class="op">(</span><span class="va">poly</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>grids<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">mypd</span><span class="op">)</span>, pd<span class="op">=</span><span class="va">mypd</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"grids"</span><span class="op">)</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="va">M</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">M</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">pd</span><span class="op">)</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span></code></pre></div>
<pre><code>##   grids       pd
## 1 v3635 4226.216
## 2 v3636 5372.009
## 3 v3637 4377.735
## 4 v3638 3783.992
## 5 v3639 3260.111
## 6 v3640 1032.685</code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_swatch.html">plot_swatch</a></span><span class="op">(</span><span class="va">M</span>, values <span class="op">=</span> <span class="va">M</span><span class="op">$</span><span class="va">pd</span>, border<span class="op">=</span><span class="cn">NA</span>, leg<span class="op">=</span><span class="fl">3</span>,
            col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span>, palette <span class="op">=</span> <span class="st">"Blue-Red 3"</span>, rev<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="phyloregion-intro_files/figure-html/unnamed-chunk-9-1.png" alt="__Figure 5.__ Geographic distributions of phylogenetic diversity for woody plants of southern Africa." width="50%"><p class="caption">
<strong>Figure 5.</strong> Geographic distributions of phylogenetic diversity for woody plants of southern Africa.
</p>
</div>
</div>
<div id="function-phylo_endemism-phylogenetic-endemism" class="section level4">
<h4 class="hasAnchor">
<a href="#function-phylo_endemism-phylogenetic-endemism" class="anchor"></a>Function <code>phylo_endemism</code> – phylogenetic endemism</h4>
<p>Phylogenetic endemism is not influenced by variations in taxonomic opinion because it measures endemism based on the relatedness of species before weighting it by their range sizes<span class="citation">(Rosauer et al. 2009)</span>,<span class="citation">(Barnabas H. Daru et al. 2020)</span>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">africa</span><span class="op">)</span>
<span class="va">comm</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">comm</span>
<span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">phylo</span>
<span class="va">poly</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">polys</span>

<span class="va">pe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phylo_endemism.html">phylo_endemism</a></span><span class="op">(</span><span class="va">comm</span>, <span class="va">tree</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">pe</span><span class="op">)</span></code></pre></div>
<pre><code>##     v3635     v3636     v3637     v3638     v3639     v3640 
## 32.536530 45.262625 35.004944 27.603721 23.183947  6.439589</code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/merge.html">merge</a></span><span class="op">(</span><span class="va">poly</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>grids<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html">names</a></span><span class="op">(</span><span class="va">pe</span><span class="op">)</span>, pe<span class="op">=</span><span class="va">pe</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"grids"</span><span class="op">)</span>
<span class="va">mx</span> <span class="op">&lt;-</span> <span class="va">mx</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">mx</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">pe</span><span class="op">)</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span></code></pre></div>
<pre><code>##   grids        pe
## 1 v3635 32.536530
## 2 v3636 45.262625
## 3 v3637 35.004944
## 4 v3638 27.603721
## 5 v3639 23.183947
## 6 v3640  6.439589</code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_swatch.html">plot_swatch</a></span><span class="op">(</span><span class="va">mx</span>, values <span class="op">=</span> <span class="va">mx</span><span class="op">$</span><span class="va">pe</span>, border<span class="op">=</span><span class="cn">NA</span>, leg<span class="op">=</span><span class="fl">3</span>,
            col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span>, palette <span class="op">=</span> <span class="st">"Blue-Red 3"</span>, rev<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="phyloregion-intro_files/figure-html/unnamed-chunk-10-1.png" alt="__Figure 6.__ Geographic distributions of phylogenetic endemism for woody plants of southern Africa." width="50%"><p class="caption">
<strong>Figure 6.</strong> Geographic distributions of phylogenetic endemism for woody plants of southern Africa.
</p>
</div>
</div>
<div id="function-edge-evolutionary-distinctiveness-and-global-endangerment" class="section level4">
<h4 class="hasAnchor">
<a href="#function-edge-evolutionary-distinctiveness-and-global-endangerment" class="anchor"></a>Function <code>EDGE</code> – Evolutionary Distinctiveness and Global Endangerment</h4>
<p>This function calculates EDGE by combining evolutionary distinctiveness (ED; i.e., phylogenetic isolation of a species) with global endangerment (GE) status as defined by the International Union for Conservation of Nature (IUCN).</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">africa</span><span class="op">)</span>
<span class="va">comm</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">comm</span>
<span class="va">threat</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">IUCN</span>
<span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">phylo</span>
<span class="va">poly</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">polys</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/EDGE.html">EDGE</a></span><span class="op">(</span><span class="va">threat</span>, <span class="va">tree</span>, Redlist <span class="op">=</span> <span class="st">"IUCN"</span>, species<span class="op">=</span><span class="st">"Species"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre><code>##        Abutilon_angulatum_OM1934    Abutilon_sonneratianum_LTM034 
##                         2.903551                         2.903551 
## Acalypha_glabrata_glabrata_OM441  Acalypha_glabrata_pilosa_OM1979 
##                         2.480505                         2.480505 
##       Acalypha_sonderiana_OM2163  Acokanthera_oblongifolia_OM2240 
##                         2.914481                         2.211561</code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map_trait.html">map_trait</a></span><span class="op">(</span><span class="va">comm</span>, <span class="va">x</span>, FUN <span class="op">=</span> <span class="va">sd</span>, shp<span class="op">=</span><span class="va">poly</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_swatch.html">plot_swatch</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">y</span><span class="op">$</span><span class="va">traits</span>, border<span class="op">=</span><span class="cn">NA</span>, leg<span class="op">=</span><span class="fl">3</span>,
            col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span>, palette <span class="op">=</span> <span class="st">"Blue-Red 3"</span>, rev<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: left">
<img src="phyloregion-intro_files/figure-html/unnamed-chunk-11-1.png" alt="__Figure 7.__ Geographic distributions of evolutionary distinctiveness and global endangerment for woody plants of southern Africa." width="50%"><p class="caption">
<strong>Figure 7.</strong> Geographic distributions of evolutionary distinctiveness and global endangerment for woody plants of southern Africa.
</p>
</div>
</div>
</div>
<div id="analysis-of-beta-diversity-phylogenetic-and-non-phylogenetic" class="section level3">
<h3 class="hasAnchor">
<a href="#analysis-of-beta-diversity-phylogenetic-and-non-phylogenetic" class="anchor"></a>Analysis of beta diversity (phylogenetic and non-phylogenetic)</h3>
<p>The three commonly used methods for quantifying -diversity, the variation in species composition among sites, – Simpson, Sorenson and Jaccard<span class="citation">(Laffan et al. 2016)</span>. The <code>phyloregion</code>’s functions <code>beta_diss</code> and <code>phylobeta</code> compute efficiently pairwise dissimilarities matrices for large sparse community matrices and phylogenetic trees for taxonomic and phylogenetic turnover, respectively. The results are stored as distance objects for subsequent analyses.</p>
<hr>
</div>
<div id="phylogenetic-beta-diversity" class="section level3">
<h3 class="hasAnchor">
<a href="#phylogenetic-beta-diversity" class="anchor"></a>Phylogenetic beta diversity</h3>
<p><code>phyloregion</code> offers a fast means of computing phylogenetic beta diversity, the turnover of branch lengths among sites, making use of and improving on the infrastructure provided by the <code>betapart</code> package<span class="citation">(Baselga and Orme 2012)</span> allowing a sparse community matrix as input.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">africa</span><span class="op">)</span>
<span class="va">sparse_comm</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">comm</span>

<span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">africa</span><span class="op">$</span><span class="va">phylo</span>
<span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/drop.tip.html">keep.tip</a></span><span class="op">(</span><span class="va">tree</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/intersect.html">intersect</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sparse_comm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">pb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phylobeta_core.html">phylobeta</a></span><span class="op">(</span><span class="va">sparse_comm</span>, <span class="va">tree</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phyloregion.html">phyloregion</a></span><span class="op">(</span><span class="va">pb</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, shp<span class="op">=</span><span class="va">africa</span><span class="op">$</span><span class="va">polys</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.phyloregion.html">plot_NMDS</a></span><span class="op">(</span><span class="va">y</span>, cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.phyloregion.html">text_NMDS</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></code></pre></div>
<p><img src="phyloregion-intro_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span><span class="op">(</span><span class="va">y</span>, palette<span class="op">=</span><span class="st">"NMDS"</span><span class="op">)</span></code></pre></div>
<p><img src="phyloregion-intro_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
</div>
</div>
<div id="session-information" class="section level2">
<h2 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session Information</h2>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.0.2 (2020-06-22)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] raster_3.3-13     sp_1.4-2          Matrix_1.2-18     ape_5.4-1        
## [5] phyloregion_1.0.7
## 
## loaded via a namespace (and not attached):
##  [1] phangorn_2.5.5      xfun_0.19           slam_0.1-47        
##  [4] splines_4.0.2       lattice_0.20-41     clustMixType_0.2-5 
##  [7] colorspace_2.0-1    geometry_0.4.5      htmltools_0.5.0    
## [10] yaml_2.2.1          mgcv_1.8-31         rlang_0.4.7        
## [13] pkgdown_1.6.1       RColorBrewer_1.1-2  stringr_1.4.0      
## [16] rgeos_0.5-3         ragg_1.1.2          codetools_0.2-16   
## [19] memoise_1.1.0       evaluate_0.14       knitr_1.29         
## [22] magic_1.5-9         permute_0.9-5       rcdd_1.2-2         
## [25] parallel_4.0.2      highr_0.8           Rcpp_1.0.5         
## [28] backports_1.1.9     vegan_2.5-6         desc_1.2.0         
## [31] betapart_1.5.1      abind_1.4-5         maptpx_1.9-7       
## [34] picante_1.8.2       systemfonts_1.0.2   fs_1.5.0           
## [37] textshaping_0.3.4   fastmatch_1.1-0     digest_0.6.25      
## [40] stringi_1.4.6       dismo_1.1-4         grid_4.0.2         
## [43] rprojroot_1.3-2     rgdal_1.5-16        quadprog_1.5-8     
## [46] tools_4.0.2         magrittr_1.5        randomForest_4.6-14
## [49] cluster_2.1.0       crayon_1.3.4        pkgconfig_2.0.3    
## [52] MASS_7.3-51.6       assertthat_0.2.1    rmarkdown_2.6      
## [55] rstudioapi_0.11     R6_2.4.1            igraph_1.2.5       
## [58] nlme_3.1-148        compiler_4.0.2</code></pre>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>REFERENCES</h2>
<div id="refs" class="references">
<div id="ref-Baselga2012">
<p>Baselga, Andrés, and C David L Orme. 2012. “Betapart: An R Package for the Study of Beta Diversity.” <em>Methods in Ecology and Evolution</em> 3 (5): 808–12.</p>
</div>
<div id="ref-Matrix">
<p>Bates, Douglas, and Martin Maechler. 2019. <em>Matrix: Sparse and Dense Matrix Classes and Methods</em>. <a href="https://CRAN.R-project.org/package=Matrix">https://CRAN.R-project.org/package=Matrix</a>.</p>
</div>
<div id="ref-crisp2001endemism">
<p>Crisp, MICHAEL D, Shawn Laffan, H Peter Linder, and ANNA Monro. 2001. “Endemism in the Australian Flora.” <em>Journal of Biogeography</em> 28 (2): 183–98.</p>
</div>
<div id="ref-Daru2015ddi">
<p>Daru, Barnabas H., Michelle van der Bank, and T. Jonathan Davies. 2015. “Spatial Incongruence Among Hotspots and Complementary Areas of Tree Diversity in Southern Africa.” <em>Diversity and Distributions</em> 21 (7): 769–80. <a href="https://doi.org/10.1111/ddi.12290">https://doi.org/10.1111/ddi.12290</a>.</p>
</div>
<div id="ref-Daru2017">
<p>Daru, Barnabas H, Tammy L Elliott, Daniel S Park, and T Jonathan Davies. 2017. “Understanding the Processes Underpinning Patterns of Phylogenetic Regionalization.” <em>Trends in Ecology &amp; Evolution</em> 32 (11): 845–60.</p>
</div>
<div id="ref-daru2020endemism">
<p>Daru, Barnabas H., Harith Farooq, Alexandre Antonelli, and Søren Faurby. 2020. “Endemism Patterns Are Scale Dependent.” <em>Nature Communications</em> 11 (1): 2115. <a href="https://doi.org/10.1038/s41467-020-15921-6">https://doi.org/10.1038/s41467-020-15921-6</a>.</p>
</div>
<div id="ref-Daru2020">
<p>Daru, Barnabas H., Piyal Karunarathne, and Klaus Schliep. 2020. “Phyloregion: R Package for Biogeographic Regionalization and Macroecology.” <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2020.02.12.945691">https://doi.org/10.1101/2020.02.12.945691</a>.</p>
</div>
<div id="ref-Duff1977">
<p>Duff, I. S. 1977. “A Survey of Sparse Matrix Research.” <em>Proceedings of the IEEE</em> 65 (4): 500–535. <a href="https://doi.org/10.1109/PROC.1977.10514">https://doi.org/10.1109/PROC.1977.10514</a>.</p>
</div>
<div id="ref-Faith1992">
<p>Faith, Daniel P. 1992. “Conservation Evaluation and Phylogenetic Diversity.” <em>Biological Conservation</em> 61 (1): 1–10. <a href="https://doi.org/10.1016/0006-3207(92)91201-3">https://doi.org/10.1016/0006-3207(92)91201-3</a>.</p>
</div>
<div id="ref-kaschner2008aquamaps">
<p>Kaschner, K, JS Ready, E Agbayani, J Rius, K Kesner-Reyes, PD Eastwood, AB South, et al. 2008. “AquaMaps: Predicted Range Maps for Aquatic Species.” <em>World Wide Web Electronic Publication, Wwwaquamapsorg, Version</em> 10: 2008.</p>
</div>
<div id="ref-Kembel2010">
<p>Kembel, S. W., P. D. Cowan, M. R. Helmus, W. K. Cornwell, H. Morlon, D. D. Ackerly, S. P. Blomberg, and C. O. Webb. 2010. “Picante: R Tools for Integrating Phylogenies and Ecology.” <em>Bioinformatics</em> 26: 1463–4.</p>
</div>
<div id="ref-laffan2003assessing">
<p>Laffan, Shawn W, and Michael D Crisp. 2003. “Assessing Endemism at Multiple Spatial Scales, with an Example from the Australian Vascular Flora.” <em>Journal of Biogeography</em> 30 (4): 511–20.</p>
</div>
<div id="ref-laffan2010biodiverse">
<p>Laffan, Shawn W, Eugene Lubarsky, and Dan F Rosauer. 2010. “Biodiverse, a Tool for the Spatial Analysis of Biological and Related Diversity.” <em>Ecography</em> 33 (4): 643–47.</p>
</div>
<div id="ref-laffan2016range">
<p>Laffan, Shawn W, Dan F Rosauer, Giovanni Di Virgilio, Joseph T Miller, Carlos E González-Orozco, Nunzio Knerr, Andrew H Thornhill, and Brent D Mishler. 2016. “Range-Weighted Metrics of Species and Phylogenetic Turnover Can Better Resolve Biogeographic Transition Zones.” <em>Methods in Ecology and Evolution</em> 7 (5): 580–88.</p>
</div>
<div id="ref-vegan">
<p>Oksanen, Jari, F. Guillaume Blanchet, Michael Friendly, Roeland Kindt, Pierre Legendre, Dan McGlinn, Peter R. Minchin, et al. 2019. <em>Vegan: Community Ecology Package</em>. <a href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</a>.</p>
</div>
<div id="ref-Paradis2018">
<p>Paradis, E., and K. Schliep. 2018. “Ape 5.0: An Environment for Modern Phylogenetics and Evolutionary Analyses in R.” <em>Bioinformatics</em> 35: 526–28.</p>
</div>
<div id="ref-Rosauer2009">
<p>Rosauer, Dan, Shawn W. Laffan, Michael D. Crisp, Stephen C. Donnellan, and Lyn G. Cook. 2009. “Phylogenetic Endemism: A New Approach for Identifying Geographical Concentrations of Evolutionary History.” <em>Molecular Ecology</em> 18 (19): 4061–72. <a href="https://doi.org/10.1111/j.1365-294X.2009.04311.x">https://doi.org/10.1111/j.1365-294X.2009.04311.x</a>.</p>
</div>
<div id="ref-TerBraak2004">
<p>Ter Braak, Cajo J. F., and I.Colin Prentice. 2004. “A Theory of Gradient Analysis.” In <em>Advances in Ecological Research: Classic Papers</em>, 34:235–82. Advances in Ecological Research. Academic Press. <a href="https://doi.org/10.1016/S0065-2504(03)34003-6">https://doi.org/10.1016/S0065-2504(03)34003-6</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Barnabas H. Daru, Piyal Karunarathne, Klaus Schliep.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
