<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fits Grade of membership models for biogeographic regionalization — fitgom • phyloregion</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fits Grade of membership models for biogeographic regionalization — fitgom"><meta property="og:description" content="Generates grade of membership, “admixture”, “topic”
or “Latent Dirichlet Allocation” models, by representing sampling units
as partial memberships in multiple groups. It can group regions
based on phylogenetic information or functional traits."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phyloregion</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Benchmark.html">Benchmarking phyloregion</a>
    </li>
    <li>
      <a href="../articles/ed.html">Fast Evolutionary Distinctiveness</a>
    </li>
    <li>
      <a href="../articles/phyloregion-intro.html">An introduction to the phyloregion package</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/darunabas/phyloregion/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fits Grade of membership models for biogeographic regionalization</h1>
    <small class="dont-index">Source: <a href="https://github.com/darunabas/phyloregion/blob/HEAD/R/fitgom.R" class="external-link"><code>R/fitgom.R</code></a></small>
    <div class="hidden name"><code>fitgom.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates grade of membership, “admixture”, “topic”
or “Latent Dirichlet Allocation” models, by representing sampling units
as partial memberships in multiple groups. It can group regions
based on phylogenetic information or functional traits.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fitgom</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  trait <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cut <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  phy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bin <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">K</span>,</span>
<span>  shape <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initopics <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  bf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  kill <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ord <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verb <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A community data in long format with one column representing
sites labeled “grids” and another column representing species
labeled “species”.</p></dd>


<dt>trait</dt>
<dd><p>A data frame or matrix object with the first column
labeled “species” containing the taxonomic groups to be
evaluated whereas the remaining columns have the various functional
traits. The variables must be a mix of numeric and categorical values.</p></dd>


<dt>cut</dt>
<dd><p>The slice time for the phylogenetic tree.</p></dd>


<dt>phy</dt>
<dd><p>is a dated phylogenetic tree with branch lengths stored
as a phylo object (as in the ape package).</p></dd>


<dt>bin</dt>
<dd><p>The desired number of clusters or bins.</p></dd>


<dt>na.rm</dt>
<dd><p>Logical, whether NA values should be removed or not.</p></dd>


<dt>K</dt>
<dd><p>The number of latent topics. If length(K)&gt;1,
topics will find the Bayes factor (vs a null single topic model)
for each element and return parameter estimates for the highest
probability K.</p></dd>


<dt>shape</dt>
<dd><p>Optional argument to specify the Dirichlet prior
concentration parameter as shape for topic-phrase probabilities.
Defaults to 1/(K*ncol(counts)). For fixed single K, this can also
be a ncol(counts) by K matrix of unique shapes for each topic element.</p></dd>


<dt>initopics</dt>
<dd><p>Optional start-location for
\([\theta_1, \ldots, \theta_K]\), the
topic-phrase probabilities. Dimensions must accord with the smallest
element of K. If NULL, the initial estimates are built by incrementally
adding topics.</p></dd>


<dt>tol</dt>
<dd><p>An indicator for whether or not to calculate the Bayes factor
for univariate K. If length(K)&gt;1, this is ignored and Bayes factors are
always calculated.</p></dd>


<dt>bf</dt>
<dd><p>An indicator for whether or not to calculate the Bayes factor
for univariate K. If length(K)&gt;1, this is ignored and Bayes factors are
always calculated.</p></dd>


<dt>kill</dt>
<dd><p>For choosing from multiple K numbers of topics (evaluated
in increasing order), the search will stop after kill consecutive drops
in the corresponding Bayes factor. Specify kill=0 if you want Bayes factors
for all elements of K.</p></dd>


<dt>ord</dt>
<dd><p>If <code>TRUE</code>, the returned topics (columns of theta) will
be ordered by decreasing usage (i.e., by decreasing <code>colSums(omega)</code>).</p></dd>


<dt>verb</dt>
<dd><p>A switch for controlling printed output. verb &gt; 0 will
print something, with the level of detail increasing with verb.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An topics object list with entries</p><ul><li><p><code>K</code> The number of latent topics estimated. If input
  <code>length(K)&gt;1</code>, on output this is a single value corresponding to
  the model with the highest Bayes factor.</p></li>
<li><p><code>theta</code> The ncolcounts by K matrix of estimated
  topic-phrase probabilities.</p></li>
<li><p><code>omega</code> The nrowcounts by K matrix of estimated
  document-topic weights.</p></li>
<li><p><code>BF</code> The log Bayes factor for each number of topics
  in the input K, against a null single topic model.</p></li>
<li><p><code>D</code> Residual dispersion: for each element of K, estimated
  dispersion parameter (which should be near one for the multinomial),
  degrees of freedom, and p-value for a test of whether the true dispersion
  is &gt;1.</p></li>
<li><p><code>X</code> The input community matrix as a sparse matrix.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Mapping phylogenetic regions (phyloregions) involves successively slicing
the phylogenetic tree at various time depths (e.g., from 1, 2, 3, 4, to 5
million years ago (Ma)), collapsing nodes and ranges that originated at
each time depth, and generating a new community matrix based on the presence
or absence of each lineage in a grid cell. A grade of membership model is
then fitted to the reduced community matrix. To map functional trait regions
(traitregions), the function uses k-means to cluster species based on their
functional traits, often for mixed-type data including categorical and
numeric functional traits. The ranges for each species in each resulting
cluster are collapsed to generate a new community matrix based on the
presence or absence of cluster representative in a grid cell. A grade of
membership model is then fitted to the new reduced community matrix. Mapping
bioregions for taxonomic diversity is based on fitting a grade of
membership model directly to the original community matrix that is often
represented with species in the columns and sites as rows.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">africa</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">africa</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "comm"  "phylo" "mat"   "IUCN"  "K"     "theta" "omega" "trait"</span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"ex/sa.json"</span>, package <span class="op">=</span> <span class="st">"phyloregion"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">fitgom</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="long2sparse.html">sparse2long</a></span><span class="op">(</span><span class="va">africa</span><span class="op">$</span><span class="va">comm</span><span class="op">)</span>, K<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating on a 365 document collection.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit and Bayes Factor Estimation for K = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log posterior increase: 3010.4, 400.2, 108, 164.1, 97, 58.5, 45, 33.4, 10.6, 16.9, 43.8, 32.3, 11.3, 1.5, 0.8, 0.2, done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log BF( 5 ) = 19683.28</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">COLRS</span> <span class="op">&lt;-</span> <span class="fu">phyloregion</span><span class="fu">:::</span><span class="fu">hue</span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">K</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_pie.html">plot_pie</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">omega</span>, pol <span class="op">=</span> <span class="va">p</span>, col<span class="op">=</span><span class="va">COLRS</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fitgom-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Barnabas H. Daru, Piyal Karunarathne, Klaus Schliep.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

